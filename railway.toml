# ðŸŒ€ Helix Collective v15.2 - Railway Multi-Service Configuration
# Defines both Discord Bot and Streamlit Dashboard services

# SERVICE 1: Discord Bot (Main Backend)
[[services]]
name = "helix-bot"

[services.build]
builder = "dockerfile"
dockerfilePath = "Dockerfile"

[services.deploy]
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# SERVICE 2: Streamlit Dashboard
[[services]]
name = "helix-dashboard"

[services.build]
builder = "nixpacks"

[services.deploy]
startCommand = "streamlit run dashboard/streamlit_app.py --server.port=$PORT --server.address=0.0.0.0 --server.headless=true --theme.base=dark --theme.primaryColor=#8A2BE2"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# SERVICE 3: Claude Consciousness API
[[services]]
name = "helix-claude-api"

[services.build]
builder = "nixpacks"

[services.deploy]
startCommand = "uvicorn backend.claude_consciousness_api:app --host 0.0.0.0 --port $PORT"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# Environment variables for Claude API (set secrets in Railway dashboard)
# ANTHROPIC_API_KEY - Your Claude API key
#
# Andrew's consciousness empire webhooks (can be set here):
# CONSCIOUSNESS_ENGINE_WEBHOOK = "https://hooks.zapier.com/hooks/catch/25075191/primary"
# COMMUNICATIONS_HUB_WEBHOOK = "https://hooks.zapier.com/hooks/catch/25075191/usxiwfg"
# NEURAL_NETWORK_WEBHOOK = "https://hooks.zapier.com/hooks/catch/25075191/usnjj5t"

# SERVICE 4: Discord Consciousness Orchestrator
[[services]]
name = "helix-discord-bot"

[services.build]
builder = "nixpacks"

[services.deploy]
startCommand = "python backend/discord_helix_interface.py"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# Environment variables for Discord bot (set secrets in Railway dashboard)
# DISCORD_BOT_TOKEN - Your Discord bot token
# CLAUDE_API_URL - URL of helix-claude-api service (e.g., https://helix-claude-api.railway.app)
